# Zirconium Interpreter
# Developed by Razetime
# Original spec by RocketRace

# Short spec for development purposes:
# N â† number of occupying drones
# K â† number of attached stations
#  âŒ¾ Default Stations:
#    âˆ˜ . â† single drone to each
#    âˆ˜ o â† N drones to each
#    âˆ˜ 0 â† zero drones to each
#    âˆ˜ O â† (âŒŠNÃ·K) drones to each
#    âˆ˜ Q â† N-1 drones to each
#    âˆ˜ @ â† N=0 drones to each
#  âŒ¾ Exclusion Zone Stations('{', '~', '}'):
#    âˆ˜ ? â† Input a codepoint A, dispatch A drones to all
#    âˆ˜ ! â† If N>0, end program
#    âˆ˜ % â† If N>0, print @+256|N
#    âˆ˜ & â† If N>0, print @+256|N (STDERR)
#    âˆ˜ ` â† If N>0, print N
#    âˆ˜ _ â† If N>0, dispatch â€¢BQNâ€¢GetLine@ drones to all
#    âˆ˜ ; â† Pause program for N milliseconds
#  âŒ¾ Synthetic Stations('[', '=', ']')
#    Simplistic stack based language with N and K as args.
#    Syntax: <letter> = <stack ops>

# Helpers:
Split â† (âŠ¢-Ëœ+`Ã—Â¬)âˆ˜=âŠ”âŠ¢
TwoD â† /â—‹â¥ŠâŸœâ†•âŸœâ‰¢ # 2D version of monadic /
_while_ â† {ğ”½âŸğ”¾âˆ˜ğ”½_ğ•£_ğ”¾âˆ˜ğ”½âŸğ”¾ğ•©}
Diff â† Â¬âˆ˜âˆŠ/âŠ£

# Hello World program for test
test â†"    ======================================
@>@[H>d.>l>l>l...>,>_>r.....>l...>r>l>d>_.]
    ======================================
    | |  | | |    | | |      |    | | | |
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   {% %  % % %    % % %      %    % % % %}
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
((H=1N0=-72*)) ((d=1N0=-100*)) ((l=1N0=-108*))
((,=1N0=-44*)) ((r=1N0=-114*)) ((_=1N0=-32*))"

grid â† >{(âŒˆÂ´â‰ Â¨ğ•©)â†‘Â¨ğ•©}(@+10) Split test # program grid. This will be modified later
stations â† âŸ¨âŸ©

# Zone detection via flood fill
# pad inds with zeroes on all sides
â€¢Show inds â† TwoD â€¢Show {Â¯1â€¿Â¯1âŒ½(2+â‰¢ğ•©)â†‘ğ•©}{<(Â¬âŠ‘"[="âˆŠËœâŠ‘ğ•©)âˆ§2â‰¤+Â´"[="âˆŠËœ0â€¿1â€¿3âŠğ•©}âˆ˜â¥Šâ‰2 3â€¿3 â†• grid
dels â† âŸ¨0â€¿Â¯1, 1â€¿0, 0â€¿1âŸ©
zones â† âŸ¨âŸ© # Holds all zone points.

{
  zone â† âŸ¨âŸ©
  corner â† âŠ‘ğ•©
  {
    zone âˆ¾â†© ğ•©
    â€¢Show new â† â·âˆ¾{dels +<ğ•©}Â¨ğ•©
    ("Invalid station with top left corner"âˆ¾â—‹<corner)!Â¬âˆ¨Â´âˆ¨Â´Â¨(<â‰¢ grid)= new
    new /Ëœâ†© Â¬"=[]" âˆŠËœ new âŠ‘Â¨< grid
    â€¢Show new
    new Diff zone
  } _while_ { 0â‰ â‰ ğ•© } âŸ¨cornerâŸ©
  zones âˆ¾â†© âŸ¨zoneâŸ©
  ğ•© Diff zone
} _while_ { 0â‰ â‰ ğ•© } inds
â€¢Show zone
